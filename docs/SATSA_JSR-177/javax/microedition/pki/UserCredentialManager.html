<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN""http://www.w3.org/TR/REC-html40/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Fri Jun 11 08:34:19 PDT 2004 -->
<TITLE>
UserCredentialManager (Security and Trust Services API (SATSA))
</TITLE>
<META NAME="keywords" CONTENT="javax.microedition.pki.UserCredentialManager,UserCredentialManager class">
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">
</HEAD>
<SCRIPT>
function asd()
{
parent.document.title="UserCredentialManager (Security and Trust Services API (SATSA))";
}
</SCRIPT>
<BODY BGCOLOR="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/UserCredentialManager.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<strong>SATSA - JSR177</strong></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="UserCredentialManager.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javax.microedition.pki</FONT>
<BR>
Class UserCredentialManager</H2>
<PRE>
<A HREF="../../../java/lang/Object.html">java.lang.Object</A>
  |
  +--<B>javax.microedition.pki.UserCredentialManager</B>
</PRE>
<HR>
<DL>
<DT>public final class <B>UserCredentialManager</B><DT>extends <A HREF="../../../java/lang/Object.html">Object</A></DL>

<P>
This class provides functionality for user credential management
 which includes 
 creating certificate signing requests, adding user credentials,
 and removing credentials that may be used to generate digital
 signatures as specified in the 
 <code>CMSMessageSignatureService</code> class.
 The initial version of credential management supports
 X.509 version 3 Certificates and URIs that resolve to X.509
 Certificates.
 <p>
 In a public key cryptographic system, a user has two distinct keys.
 One key is kept private while the other is made public. There are
 a number of public key cryptographic systems, some of which may
 be used for the creation of digital signatures (for example, DSA), while
 others can be used for encryption (for example, Rabin). Some systems may
 be used for both encryption and digital signatures (for example, RSA).
 Generally the private key, which is only known to the user,
 is used to generate a signature or to decrypt a message. The
 public key, as can be deduced from the name, is public knowledge
 and is used to verify the user's signature or to encrypt
 information intended for the user.
 </p>

 <p>
 When selecting a public key to encrypt a message or verify a
 digital signature, it is important to be able to link the public
 key either to the user for which the encrypted message is intended or to
 the user that generated the signature. Public key infrastructure
 (PKI) provides a mechanism for binding an identity to a public
 key. The binding is expressed in a data structure known as a
 certificate. The X.509 certificate format is one of the most
 widely adopted certificate formats. X.509 certificates generally
 contain at least the following information:
 <ul>
 <li>
 An X.500 name that can potentially be linked to the identity
 of the user.
 </li>
 <li>
 The public key associated with the X.500 name.
 </li>
 <li>
 A validity period for the certificate (Not Before and Not After).
 </li>
 <li>
 Information on the certificate issuer (an X.500 name for the
 issuer and a serial number). This uniquely identifies a
 certificate in a PKI.
 </li>
 </ul>

 The certificate may contain additional information. The certificate
 itself is signed by the certificate issuer. The certificate issuer
 is usually referred to as a Certificate Authority (CA).
 </p>

 <p>
 The process that a CA follows before issuing a certificate is
 governed by the certification practice statement (CPS) of the
 CA. This usually involves both technical and non-technical
 steps that need to be completed before a certificate is issued.
 Technical steps include obtaining the public key that must be
 certified, verifying that the user is in possession of the
 corresponding private key, and returning the certificate or a
 reference to the certificate once it is issued. Non-technical
 steps include the processes followed to establish the
 certificate requesters identity.
 Upon completion of the technical and non-technical steps of the
 registration process, the user is said to be enrolled into the PKI.
 </p>

 <p>
 The purpose of this class is to provide the technical building
 blocks required to enroll a user in a PKI. This will allow a
 user to obtain a certificate that can be used in conjunction
 with the <code>sign</code> and <code>authenticate</code> methods
 in the <code>
 javax.microedition.securityservice.CMSMessageSignatureService
 </code> class.
 This can also be used for
 renewing and deleting certificates once they have expired. 
 With this package it is possible to:
 <ul>
 <li>
 Obtain a certificate signing request that can be sent to a PKI.
 </li>
 <li>
 Add a certificate or certificate URI to a certificate store.
 </li>
 <li>
 Remove a certificate or certificate URI from a certificate store.
 </li>
 </ul>
 </p>

 <h2>Example</h2>

 <pre>
    // Parameters for certificate request message.
    String nameInfo = new String("CN=User Name");
    byte[] enrollmentRequest = null;
    int keyLength = 1024;

    // User friendly names and prompts.
    String securityElementID = new String("Bank XYZ");
    String securityElementPrompt = new String
        ("Please insert bank XYZ security element before proceeding");
    String friendlyName = new String("My Credential");

    // Certificate chain and URI from registration response.
    byte[] pkiPath; 
    String uri;     
 
 
    // Obtain a certificate enrollment request message.
    try {
        enrollmentRequest = UserCredentialManager.generateCSR
            (nameInfo, UserCredentialManager.ALGORITHM_RSA, keyLength,
             UserCredentialManager.KEY_USAGE_NON_REPUDIATION, 
             securityElementID, securityElementPrompt, false);
 
        // Send it to a registration server.
         ...
        // Assign values for pkipath and certificate uri
        // from the registration response.
         ...
 
        // Store the certificate on the security element.
        UserCredentialManager.addCredential(friendlyName,
                                            pkiPath, uri);
    } catch (IllegalArgumentException iae) {
        iae.printStackTrace();
    } catch (NullPointerException npe) {
        npe.printStackTrace();
    } catch (CMSMessageSignatureServiceException cmse) {
        cmse.printStackTrace();
    } catch (UserCredentialManagerException pkie) {
        pkie.printStackTrace();
    }

 </pre>
 <p>
 <h2>Note regarding UI implementations</h2>
 </p>
 <p>
 User prompts and notifications should be implemented in such a way that:
 <ul>
 <li>
 the UI is distinguishable from a UI generated by external sources 
 (for example J2ME applications).
 </li>
 <li>
 external sources are not able to modify the data presented to the user.
 </li>
 <li>
 external sources are not able to retrieve the PIN data.
 </li>
 </ul>
 </p>
<P>

<P>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Field Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../java/lang/String.html">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#ALGORITHM_DSA">ALGORITHM_DSA</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algorithm identifier for a DSA signature key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../java/lang/String.html">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#ALGORITHM_RSA">ALGORITHM_RSA</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algorithm identifier for an RSA signature key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#KEY_USAGE_AUTHENTICATION">KEY_USAGE_AUTHENTICATION</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indicates a key used for authentication.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#KEY_USAGE_NON_REPUDIATION">KEY_USAGE_NON_REPUDIATION</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indicates a key used for digital signatures.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#addCredential(java.lang.String, byte[], java.lang.String)">addCredential</A></B>(<A HREF="../../../java/lang/String.html">String</A>&nbsp;certDisplayName,
              byte[]&nbsp;pkiPath,
              <A HREF="../../../java/lang/String.html">String</A>&nbsp;uri)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a user certificate or certificate
 URI to a certificate store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#generateCSR(java.lang.String, java.lang.String, int, int, java.lang.String, java.lang.String, boolean)">generateCSR</A></B>(<A HREF="../../../java/lang/String.html">String</A>&nbsp;nameInfo,
            <A HREF="../../../java/lang/String.html">String</A>&nbsp;algorithm,
            int&nbsp;keyLen,
            int&nbsp;keyUsage,
            <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementID,
            <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementPrompt,
            boolean&nbsp;forceKeyGen)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a DER encoded PKCS#10 certificate enrollment request.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/pki/UserCredentialManager.html#removeCredential(java.lang.String, byte[], java.lang.String, java.lang.String)">removeCredential</A></B>(<A HREF="../../../java/lang/String.html">String</A>&nbsp;certDisplayName,
                 byte[]&nbsp;issuerAndSerialNumber,
                 <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementID,
                 <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementPrompt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes a certificate or certificate
 URI from a certificate store.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.<A HREF="../../../java/lang/Object.html">Object</A></B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../java/lang/Object.html#equals(java.lang.Object)">equals</A>, <A HREF="../../../java/lang/Object.html#getClass()">getClass</A>, <A HREF="../../../java/lang/Object.html#hashCode()">hashCode</A>, <A HREF="../../../java/lang/Object.html#notify()">notify</A>, <A HREF="../../../java/lang/Object.html#notifyAll()">notifyAll</A>, <A HREF="../../../java/lang/Object.html#toString()">toString</A>, <A HREF="../../../java/lang/Object.html#wait()">wait</A>, <A HREF="../../../java/lang/Object.html#wait(long)">wait</A>, <A HREF="../../../java/lang/Object.html#wait(long, int)">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Field Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="ALGORITHM_RSA"><!-- --></A><H3>
ALGORITHM_RSA</H3>
<PRE>
public static final <A HREF="../../../java/lang/String.html">String</A> <B>ALGORITHM_RSA</B></PRE>
<DL>
<DD>Algorithm identifier for an RSA signature key.
 This is the <code>String</code> representation of the
 OID identifying the RSA algorithm.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#javax.microedition.pki.UserCredentialManager.ALGORITHM_RSA">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="ALGORITHM_DSA"><!-- --></A><H3>
ALGORITHM_DSA</H3>
<PRE>
public static final <A HREF="../../../java/lang/String.html">String</A> <B>ALGORITHM_DSA</B></PRE>
<DL>
<DD>Algorithm identifier for a DSA signature key.
 This is the <code>String</code> representation of the
 OID identifying a DSA signature key.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#javax.microedition.pki.UserCredentialManager.ALGORITHM_DSA">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="KEY_USAGE_AUTHENTICATION"><!-- --></A><H3>
KEY_USAGE_AUTHENTICATION</H3>
<PRE>
public static final int <B>KEY_USAGE_AUTHENTICATION</B></PRE>
<DL>
<DD>Indicates a key used for authentication.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#javax.microedition.pki.UserCredentialManager.KEY_USAGE_AUTHENTICATION">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="KEY_USAGE_NON_REPUDIATION"><!-- --></A><H3>
KEY_USAGE_NON_REPUDIATION</H3>
<PRE>
public static final int <B>KEY_USAGE_NON_REPUDIATION</B></PRE>
<DL>
<DD>Indicates a key used for digital signatures.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#javax.microedition.pki.UserCredentialManager.KEY_USAGE_NON_REPUDIATION">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="generateCSR(java.lang.String, java.lang.String, int, int, java.lang.String, java.lang.String, boolean)"><!-- --></A><H3>
generateCSR</H3>
<PRE>
public static final byte[] <B>generateCSR</B>(<A HREF="../../../java/lang/String.html">String</A>&nbsp;nameInfo,
                                       <A HREF="../../../java/lang/String.html">String</A>&nbsp;algorithm,
                                       int&nbsp;keyLen,
                                       int&nbsp;keyUsage,
                                       <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementID,
                                       <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementPrompt,
                                       boolean&nbsp;forceKeyGen)
                                throws <A HREF="../../../javax/microedition/pki/UserCredentialManagerException.html">UserCredentialManagerException</A>,
                                       <A HREF="../../../javax/microedition/securityservice/CMSMessageSignatureServiceException.html">CMSMessageSignatureServiceException</A></PRE>
<DL>
<DD>Creates a DER encoded PKCS#10 certificate enrollment request.
 <p>
 The implementation uses the <code>securityElementID</code>
 and the <code>securityElementPrompt</code> to
 choose an appropriate security element. 
 If an appropriate
 security element cannot be found, a
 <code>UserCredentialManagerException</code> is thrown and
 the <code>getReason</code> method MUST return
 <code>SE_NOT_FOUND</code>.
 The implementation MUST use the <code>algorithm</code>,
 <code>keyLen</code>, and <code>keyUsage</code> parameters
 to select a specific key to use in signing the 
 certificate request.
 If the algorithm is not supported or the specific key
 parameters can not be fulfilled,  then a
 <code>UserCredentialManagerException</code> MUST be thrown
 and the <code>getReason</code> method MUST return
 <code>SE_NO_KEYS</code>. 
 </p>

 <p>
 If the platform can select a security element and the security
 element contains multiple keys, it is up to the platform to
 select an appropriate key
 (when key generation is not forced). 

 If a key is found that is not yet associated with a user
 certificate or a user certificate request, the platform MUST
 select such a key in preference to keys that are already
 associated with a user certificate or certificate request. 

 If all keys are associated with a certificate or a certificate
 request, the implementation MUST select the key associated with
 a certificate request in preference to keys that are 
 associated with a certificate.

 If all keys are already associated with a user certificate and
 key generation was not forced, the platform MAY select one
 of the existing keys for inclusion in the certificate signing
 request, depending on the security element policy.
 </p>

 <p>
 The application requests key generation by setting the
 <code>forceKeyGen</code> flag. 
 If a key is requested of a security element that is not 
 capable of key generation, a
 <code>UserCredentialManagerException</code> MUST be thrown
 and the <code>getReason</code> method MUST return
 <code>SE_NO_KEYGEN</code>. If the key can not be 
 generated with the requested key parameters, a
 <code>UserCredentialManagerException</code> MUST be thrown
 and the <code>getReason</code> method MUST return
 <code>SE_NO_KEYS</code>.
 If the security element requires the user to specify a new PIN
 that is used to protect the keys to be generated, the implementation
 of this method is responsible for collecting the new PIN from the user.
 </p>

 <p>
 If a security element is found, but it contains no 
 keys that can be used, then a
 <code>UserCredentialManagerException</code> MUST be thrown
 and the <code>getReason</code> method MUST return
 <code>SE_NO_KEYS</code>.
 If a security element is found, but all available 
 keys have been associated with certificates and
 if the platform does not allow selection of keys already
 associated with certificates, then a
 <code>UserCredentialManagerException</code> MUST be thrown
 and the <code>getReason</code> method MUST return
 <code>SE_NO_UNASSOCIATED_KEYS</code>.
 </p>
 <p>
 If a security element can be selected and an appropriate
 key is available (either generated or already existing)
 the certification request is generated and formatted. The
 certification request will be formatted as a PKCS#10
 certificate request. The request may contain
 additional attributes.
 </p>
 <p>
 See "X.690 - Information technology - ASN.1 encoding rules:
 Specification of Basic Encoding Rules (BER),
 Canonical Encoding Rules (CER) and
 Distinguished Encoding Rules (DER)" at
 <a href=
 "http://www.itu.int/ITU-T/studygroups/com17/languages/">
 http://www.itu.int/ITU-T/studygroups/com17/languages/
 </a> for details about ASN.1 encoding rules.
 
 </p>
 <p>
 Generation of the certificate enrollment request and the key pair 
 must be confirmed by the user. The user should have the option
 to view the detailed information of the key used in signing the
 certificate request, such as
 the key usage, key length, public key algorithm.
 This method returns <code>null</code> if the user cancels the
 certificate enrollment request.
 </p>
 <p>
 Authorization to generate certificate enrollment request is
 also subject to the policy
 of the underlying security element. If user authorization is required 
 through the entry of PIN, the implementation of this method 
 is responsible for collecting the PIN from the user. Incorrect
 PIN entry is handled by
 the implementation. The number of retries following incorrect
 PIN entry is
 governed by the security element policy. If the PIN is blocked due to an 
 excessive number of incorrect PIN entries, the implementation
 must throw a
 <code>SecurityException</code> exception.
 </p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nameInfo</CODE> - the distinguished name
 to be included in the PKCS#10 certificate signing request.
 The distinguished name MUST follow the encoding rules of
 <a href="http://www.ietf.org/rfc/rfc2253.txt">
 RFC2253</a>. If <code>null</code> is passed as the
 parameter value, it is up to the implementation to
 choose an appropriate distinguished name (for example, the WIM
 serial number).
 If <code>nameInfo</code> is empty or not formatted according
 RFC2253 an <code>IllegalArgumentException</code> is thrown.<DD><CODE>algorithm</CODE> - the Object Identifier (OID) for the public key
 algorithm to use. (see     
 <a href="http://www.ietf.org/rfc/rfc1778.txt">RFC 1778</a>)
 The static variables
 <code>UserCredentialManager.ALGORITHM_RSA</code> and
 <code>UserCredentialManager.ALGORITHM_DSA</code> may
 be used to indicate either RSA or DSA signature keys.
 If <code>algorithm</code> is empty or not formatted according
 RFC1778 an <code>IllegalArgumentException</code> is thrown.
 If the requested <code>algorithm</code> is not supported
 on the platform then a
 <code>UserCredentialManagerException</code> MUST be thrown
 and the <code>getReason</code> method MUST return
 <code>SE_NO_KEYS</code>.<DD><CODE>keyLen</CODE> - the key length (typically 1024 for RSA)
 If <code>keyLen</code> is incorrect an 
 <code>IllegalArgumentException</code> is thrown.<DD><CODE>keyUsage</CODE> - the functionality for which the key is marked
 inside the security element. This may be one of
 <code>UserCredentialManager.KEY_USAGE_AUTHENTICATION</code>
 or
 <code>UserCredentialManager.KEY_USAGE_NON_REPUDIATION</code>.
 If <code>keyUsage</code> is incorrect an 
 <code>IllegalArgumentException</code> is thrown.<DD><CODE>securityElementID</CODE> - identifies the security element on
 which the key resides or will be generated. 
 If this parameter is
 <code>null</code> the implementation MUST choose the first
 available security element that meets the specified requirements.
 If no appropriate security element is found, the
 <code>securityElementPrompt</code> parameter MUST be used
 to guide the user on selecting the correct security element.
 If no security element can be selected, a
 <code>UserCredentialManagerException</code> is thrown and
 the <code>getReason</code> method MUST return
 <code>SE_NOT_FOUND</code>.<DD><CODE>securityElementPrompt</CODE> - guides a user to insert the
 correct security element, if the suitable security element is
 removable and not detected. 
 If this parameter is set to <code>null</code>, a user prompt is not
 used to guide the user to select an appropriate security element.<DD><CODE>forceKeyGen</CODE> - if set to <code>true</code> a new key MUST be
 generated. If the security element does not support key generation
 it MUST throw an <code>UserCredentialManagerException</code> and
 the <code>getReason</code> method MUST return a
 <code>SE_NO_KEYGEN</code> error code.
 If set to <code>false</code> no key
 generation is required and an existing key may be used.
<DT><B>Returns:</B><DD>DER encoded PKCS#10 certificate enrollment request, or
 <code>null</code> if the certificate
 enrollment request was cancelled by the user before completion.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../java/lang/IllegalArgumentException.html">IllegalArgumentException</A></CODE> - if the parameters are not valid
<DD><CODE><A HREF="../../../javax/microedition/pki/UserCredentialManagerException.html">UserCredentialManagerException</A></CODE> - if an error occurs while
 generating the certificate request
<DD><CODE><A HREF="../../../java/lang/SecurityException.html">SecurityException</A></CODE> - if the caller is not
 authorized to access the user certificate store
<DD><CODE><A HREF="../../../javax/microedition/securityservice/CMSMessageSignatureServiceException.html">CMSMessageSignatureServiceException</A></CODE> - if an
 error occurs while signing the certificate request</DL>
</DD>
</DL>
<HR>

<A NAME="addCredential(java.lang.String, byte[], java.lang.String)"><!-- --></A><H3>
addCredential</H3>
<PRE>
public static final boolean <B>addCredential</B>(<A HREF="../../../java/lang/String.html">String</A>&nbsp;certDisplayName,
                                          byte[]&nbsp;pkiPath,
                                          <A HREF="../../../java/lang/String.html">String</A>&nbsp;uri)
                                   throws <A HREF="../../../javax/microedition/pki/UserCredentialManagerException.html">UserCredentialManagerException</A></PRE>
<DL>
<DD>Adds a user certificate or certificate
 URI to a certificate store.
 <p>
 A credential is registered using an ordered sequence of
 certificates, called a PKI Path.
 The PKI Path is defined in <A HREF=
 "ftp://ftp.bull.com/pub/OSIdirectory/DefectResolution/TechnicalCorrigenda/ApprovedTechnicalCorrigendaToX.509/8%7CX.509-TC3%284th%29.pdf">
 ITU-T RECOMMENDATION X.509 (2000) | ISO/IEC 9594-8:2001, 
 Technical Corrigendum 1 (DTC 2) </A> and is used
 by the J2SE <A HREF=
 "http://java.sun.com/j2se/1.4.1/docs/guide/security/certpath/CertPathProgGuide.html#AppA">
 CertPath Encodings</A>.</p>
 <p>
 <strong>PkiPath:</strong> an ASN.1 DER encoded sequence of
 certificates, defined as follows:<pre>
      <code>PkiPath ::= SEQUENCE OF Certificate</code>
 </pre>
 Within the sequence, the order of certificates is such that the
 subject of the first certificate is the issuer of the second
 certificate, etc. Each certificate in PkiPath shall be
 unique. No certificate may appear more than once in a value of
 Certificate in PkiPath. The last certificate is the end entity
 user certificate.
 </p>
 <p>
 The use of the certificate URI is platform dependent.
 Some platforms may not store the user certificate, but may
 instead keep a copy of the URI. 
 If only the URI is retained instead of the certificates
 included in the pkiPath, the implementation MUST parse the user
 certificate in the pkiPath to obtain relevant information such
 as the issuing CA name, the user certificate serial number, the
 public key, and user distinguished name. Some of these fields
 may be required by the underlying security element.
 The certificate URI parameter can be
 <code>null</code> in deployments where off device access to
 certificate storage is not supported.
 </p>
 <p>
 Some platforms MAY store the credential information with
 a specific security element, while other platforms MAY
 have a central repository for credentials. It is platform
 dependent where the information is maintained.
 </p>
 <p> 
 Storing the requested credential must be confirmed by the
 user. The implementation must display the user friendly
 name of the certificate or the certificate URL. The user should
 have the option
 to view the detailed information of the credential, such as the
 certificate issuer, certificate subject, and certificate
 validity period.
 This method returns <code>false</code> if the user cancels the
 request to add the credential.
 </p>
 <p>
 Authorization to store the requested credential is also subject
 to the policy
 of the underlying security element or the platform. If user
 authorization is required
 through the entry of PIN, the implementation of this method 
 is responsible for collecting the PIN from the user. Incorrect
 PIN entry is handled by
 the implementation. The number of retries following incorrect
 PIN entry is
 governed by the policy of the security element or the
 platform. If the PIN is blocked due to an
 excessive number of incorrect PIN entries, the implementation
 must throw a
 <code>SecurityException</code> exception.
 </p>
 If the requested certificate can not be stored, a
 <code>UserCredentialManagerException</code> is thrown and
 the <code>getReason</code> method MUST return
 <code>CREDENTIAL_NOT_SAVED</code>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certDisplayName</CODE> - the user friendly
 name associated with the certificate.
 If <code>certDisplayName</code> is <code>null</code> or
 an empty string an <code>IllegalArgumentException</code>
 is thrown. Applications MUST use unique user
 friendly names to make selection easier.
 If the <code>certDisplayName</code> is already
 registered, an <code>IllegalArgumentException</code>
 is thrown.<DD><CODE>pkiPath</CODE> - the DER encoded PKIPath containing user
 certificate and certificate authority certificates.
 If <code>pkiPath</code> is <code>null</code> or
 incorrectly formatted an <code>IllegalArgumentException</code>
 is thrown. 
 If <code>pkiPath</code> is already registered, 
 an <code>IllegalArgumentException</code> is thrown.<DD><CODE>uri</CODE> - a URI that resolves to a X.509v3 certificate.
 The uri can be <code>null</code>.
<DT><B>Returns:</B><DD><code>false</code> if the operation to add the
 credential was cancelled by the user
 before completion.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../java/lang/IllegalArgumentException.html">IllegalArgumentException</A></CODE> - if parameters are not
  valid
<DD><CODE><A HREF="../../../javax/microedition/pki/UserCredentialManagerException.html">UserCredentialManagerException</A></CODE> - if an error occurs
 while adding a user credential
<DD><CODE><A HREF="../../../java/lang/SecurityException.html">SecurityException</A></CODE> - if the caller is not
 authorized to add to the user certificate store</DL>
</DD>
</DL>
<HR>

<A NAME="removeCredential(java.lang.String, byte[], java.lang.String, java.lang.String)"><!-- --></A><H3>
removeCredential</H3>
<PRE>
public static final boolean <B>removeCredential</B>(<A HREF="../../../java/lang/String.html">String</A>&nbsp;certDisplayName,
                                             byte[]&nbsp;issuerAndSerialNumber,
                                             <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementID,
                                             <A HREF="../../../java/lang/String.html">String</A>&nbsp;securityElementPrompt)
                                      throws <A HREF="../../../javax/microedition/pki/UserCredentialManagerException.html">UserCredentialManagerException</A></PRE>
<DL>
<DD>Removes a certificate or certificate
 URI from a certificate store.
 <p>
 Removal of the credential from the certificate store
 must be confirmed by the user. The implementation must display
 the user friendly
 name of the certificate or the certificate URL. The user should
 have the option
 to view the detailed information of the credential, such as the
 certificate issuer, certificate subject, and certificate
 validity period.
 This method returns <code>false</code> if the user cancels the
 request to remove the credential.
 </p>
 <p>
 Authorization to remove the requested credential is also
 subject to the policy
 of the underlying security element or the platform. If user
 authorization is required
 through the entry of PIN, the implementation of this method 
 is responsible for collecting the PIN from the user. Incorrect
 PIN entry is handled
 by the implementation. The number of retries following
 incorrect PIN entry is
 governed by the policy of the security element or the
 platform. If the PIN is blocked due to an
 excessive number of incorrect PIN entries, the implementation
 must throw a
 <code>SecurityException</code> exception.
 </p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certDisplayName</CODE> - the user friendly
 name associated with the certificate.
 If <code>certDisplayName</code> is <code>null</code> or
 an empty string an <code>IllegalArgumentException</code>
 is thrown.<DD><CODE>issuerAndSerialNumber</CODE> - the DER encoded ASN.1 structure
 that contains the certificate issuer and serial number as
 defined in <a href="http://www.ietf.org/rfc/rfc3369.txt">
 RFC 3369</a>.
 If <code>issuerAndSerialNumber</code> is <code>null</code> or
 not properly formatted according to RFC3369
 an <code>IllegalArgumentException</code> is thrown.
 If the requested certificate is not found, a
 <code>UserCredentialManagerException</code> is thrown and
 the <code>getReason</code> method MUST return
 <code>CREDENTIAL_NOT_FOUND</code>.<DD><CODE>securityElementID</CODE> - identifies the security element on
 which the key resides.  If this parameter is
 <code>null</code> the implementation MUST choose the first
 available security element that meets the specified requirements.
 If no appropriate security element is found, the
 <code>securityElementPrompt</code> parameter MUST be used
 to guide the user on selecting the correct security element.
 If no security element can be selected, a
 <code>UserCredentialManagerException</code> is thrown and
 the <code>getReason</code> method MUST return
 <code>SE_NOT_FOUND</code>.<DD><CODE>securityElementPrompt</CODE> - guides the user to insert 
 the correct security element if the security element is
 removable and not detected. 
 If this parameter is set to <code>null</code>, no information
 regarding which security element to use is displayed to
 the user.
<DT><B>Returns:</B><DD><code>false</code> if the operation to remove the 
 credential was cancelled by the user
 before completion.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../java/lang/IllegalArgumentException.html">IllegalArgumentException</A></CODE> - if the parameters are not valid
<DD><CODE><A HREF="../../../javax/microedition/pki/UserCredentialManagerException.html">UserCredentialManagerException</A></CODE> - if an error occurs
 while removing the credential
<DD><CODE><A HREF="../../../java/lang/SecurityException.html">SecurityException</A></CODE> - if the caller is not
 authorized to remove from the user certificate store</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/UserCredentialManager.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<strong>SATSA - JSR177</strong></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="UserCredentialManager.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<font size="-1"><a href="mailto:JSR-177-EG@JCP.ORG"> Submit a comment or suggestion</a> Version 1.0 of SATSA Specification<br>Java is a trademark or registered trademark of Sun Microsystems,  Inc. in the US and other countries. Copyright 1993-2004 Sun Microsystems, Inc. 901 San Antonio Road,Palo Alto, California, 94303, U.S.A. All Rights Reserved.</font>
</BODY>
</HTML>
