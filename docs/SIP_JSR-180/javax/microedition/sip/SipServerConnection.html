<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN""http://www.w3.org/TR/REC-html40/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Wed Nov 26 13:59:56 EET 2003 -->
<TITLE>
SipServerConnection (JSR180 SIP API for J2ME)
</TITLE>
<META NAME="keywords" CONTENT="javax.microedition.sip.SipServerConnection,SipServerConnection interface">
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">
</HEAD>
<SCRIPT>
function asd()
{
parent.document.title="SipServerConnection (JSR180 SIP API for J2ME)";
}
</SCRIPT>
<BODY BGCOLOR="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/sip/SipRefreshListener.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/sip/SipServerConnectionListener.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SipServerConnection.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javax.microedition.sip</FONT>
<BR>
Interface SipServerConnection</H2>
<DL>
<DT><B>All Superinterfaces:</B> <DD>javax.microedition.io.Connection, <A HREF="../../../javax/microedition/sip/SipConnection.html">SipConnection</A></DD>
</DL>
<HR>
<DL>
<DT>public interface <B>SipServerConnection</B><DT>extends <A HREF="../../../javax/microedition/sip/SipConnection.html">SipConnection</A></DL>

<P>
<tt>SipServerConnection</tt> represents SIP server transaction.
 <tt>SipServerConnection</tt> is created by the <tt>SipConnectionNotifier</tt> 
 when a new request is received.
 <br>
 <br>
 The <tt>SipServerConnection</tt> has following state chart:<br>
 <IMG SRC="./jsr180-server-state-chart.gif" width=562 height=272>
 <UL>
 <LI> <em>Request Received</em>, <tt>SipServerConnection</tt> returned from 
      <tt>SipConnectionNotifier</tt> or provisional response(s) (1xx) sent.
 <LI> <em>Initialized</em>, response initialized calling <tt>initResponse()</tt>
 <LI> <em>Stream Open</em>, <tt>OutputStream</tt> opened with 
      <tt>openContentOutputStream()</tt>. Opening <tt>InputStream</tt> for
      received request does not trigger state transition.
 <LI> <em>Completed</em>, transaction completed with sending final response 
      (2xx, 3xx, 4xx, 5xx, 6xx)
 <LI> <em>Terminated</em>, the final state, in which the SIP connection has been 
      terminated by error or closed
 </UL>
 <FONT SIZE="2"><b>Note:</b> The state chart of <tt>SipServerConnection</tt> 
 differs from the state chart of SIP server transaction, which can be found in 
 RFC 3261 [1] p.136-140</FONT>
 <br><br>
 Following methods are accessible in each state.
 <UL>
 <LI> <em>Request Received</em><br><code>
            initResponse<br>
            openContentInputStream<br></code>
 <LI> <em>Initialized</em><br><code>
            addHeader<br>
            setHeader<br>
            removeHeader<br>
            setReasonPhrase<br>
            openContentOutputStream<br>
            send<br></code>
 <LI> <em>Stream Open</em><br>
            Methods in <code>OutputStream</code> and <code>SipConnection.send</code>
 <LI> <em>Completed</em><br>
            All get-methods, see below
 <LI> <em>Terminated</em><br>
            The transaction and this connection is closed. The I/O methods above will throw IOException</tt>
 </UL>
 Following methods can be called in every state. The functionality is defined by the method depending of the information availability.
 <UL>
 <LI> <em>Can be called in every state</em><br><code>
     getHeader<br>
     getHeaders<br>
     getRequestURI<br>
     getMethod<br>
     getStatusCode<br>
     getReasonPhrase<br>
     getDialog<br>
     close    </code>        // causes state transition to <em>Terminated</em> state
 </UL>
<H3>Code Examples</H3>
 Following code example illustrates the usage of SIP server connection: opening, 
 receiving one request (MESSAGE) and sending response:
<pre>
 public receiveMessage() {
    SipConnectionNotifier scn = null;
    SipServerConnection ssc = null;
    String method = null;
   
    try {
       // Open SIP server connection and listen to port 5060
       scn = (SipConnectionNotifier) Connector.open("sip:5060");
      
       // block and wait for incoming request.
       // SipServerConnection is establised and returned
       // when new request is received.
       ssc = scn.acceptAndOpen();

      // what was the SIP method
      method = ssc.getMethod();
      if(method.equals("MESSAGE")) {
         // read the content of the MESSAGE
         String contentType = ssc.getHeader("Content-Type");
         if((contentType != null) && contentType.equals("text/plain")) {
            InputStream is = ssc.openContentInputStream();
            int ch;
            // read content
            while ((ch = is.read()) != -1) {
             ...
            }
         }
         // initialize SIP 200 OK and send it back
         ssc.initResponse(200);
         ssc.send();
         ssc.close();
      }
    } catch(Exception ex) {
     // handle IOException, InterruptedIOException, SecurityException
     // or SipException
    }
 }
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html"><CODE>SipConnectionNotifier</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipServerConnectionListener.html"><CODE>SipServerConnectionListener</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipClientConnection.html"><CODE>SipClientConnection</CODE></A></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipServerConnection.html#initResponse(int)">initResponse</A></B>(int&nbsp;code)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializes <tt>SipServerConnection</tt> with a specific SIP response 
 to the received request.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipServerConnection.html#setReasonPhrase(java.lang.String)">setReasonPhrase</A></B>(java.lang.String&nbsp;phrase)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Changes the default reason phrase.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_javax.microedition.sip.SipConnection"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from interface javax.microedition.sip.<A HREF="../../../javax/microedition/sip/SipConnection.html">SipConnection</A></B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../javax/microedition/sip/SipConnection.html#addHeader(java.lang.String, java.lang.String)">addHeader</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getDialog()">getDialog</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getHeader(java.lang.String)">getHeader</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getHeaders(java.lang.String)">getHeaders</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getMethod()">getMethod</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getReasonPhrase()">getReasonPhrase</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getRequestURI()">getRequestURI</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getStatusCode()">getStatusCode</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#openContentInputStream()">openContentInputStream</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#openContentOutputStream()">openContentOutputStream</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#removeHeader(java.lang.String)">removeHeader</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#send()">send</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#setHeader(java.lang.String, java.lang.String)">setHeader</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_javax.microedition.io.Connection"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from interface javax.microedition.io.Connection</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>close</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="initResponse(int)"><!-- --></A><H3>
initResponse</H3>
<PRE>
public void <B>initResponse</B>(int&nbsp;code)
                  throws java.lang.IllegalArgumentException,
                         <A HREF="../../../javax/microedition/sip/SipException.html">SipException</A></PRE>
<DL>
<DD>Initializes <tt>SipServerConnection</tt> with a specific SIP response 
 to the received request. The default headers and reason phrase will be initialized 
 automatically. After this the <tt>SipServerConnection</tt> is in 
 <em>Initialized</em> state. The response can be sent.
 <p>
 The procedure of generating the response and header fields 
 is defined in RFC 3261 [1] p. 49-50. At least following information is set by the method:
 <pre>
    From     // MUST equal the From header field of the request
    Call-ID  // MUST equal the Call-ID header field of the request
    CSeq     // MUST equal the CSeq field of the request
    Via      // MUST equal the Via header field values in the request 
                and MUST maintain the same ordering
    To       // MUST Copy if exists in the original request, 
                'tag' MUST be added if not present
 </pre>
 Furthermore, if the system has automatically sent the "100 Trying" response, the 100 response initialized
 and sent by the user is just ignored.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>code</CODE> - Response status code 1xx - 6xx
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the status code is out of range 100-699 (RFC 3261 p.28-29)
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html">SipException</A></CODE> - INVALID_STATE if the response can not be initialized, because of wrong state.</DL>
</DD>
</DL>
<HR>

<A NAME="setReasonPhrase(java.lang.String)"><!-- --></A><H3>
setReasonPhrase</H3>
<PRE>
public void <B>setReasonPhrase</B>(java.lang.String&nbsp;phrase)
                     throws <A HREF="../../../javax/microedition/sip/SipException.html">SipException</A>,
                            java.lang.IllegalArgumentException</PRE>
<DL>
<DD>Changes the default reason phrase.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the reason phrase is illegal.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html">SipException</A></CODE> - INVALID_STATE if the response can not be initialized, because of wrong state. INVALID_OPERATION if the reason phrase can not be set.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/sip/SipRefreshListener.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/sip/SipServerConnectionListener.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SipServerConnection.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<font size=-1>Copyright &copy; 2003 Nokia Corporation. All Rights Reserved.<br/>  Java is a trademark of Sun Microsystems, Inc.
</BODY>
</HTML>
