<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN""http://www.w3.org/TR/REC-html40/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Thu Nov 27 13:54:35 EET 2003 -->
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<TITLE>
Loader (Mobile 3D Graphics API (M3G))
</TITLE>
<META NAME="keywords" CONTENT="javax.microedition.m3g.Loader,Loader class">
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">
</HEAD>
<SCRIPT>
function asd()
{
parent.document.title="Loader (Mobile 3D Graphics API (M3G))";
}
</SCRIPT>
<BODY BGCOLOR="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Loader.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<EM><B>Nov 19, 2003</B></EM></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/m3g/Light.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/m3g/Material.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Loader.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javax.microedition.m3g</FONT>
<BR>
Class Loader</H2>
<PRE>
java.lang.Object
  |
  +--<B>javax.microedition.m3g.Loader</B>
</PRE>
<HR>
<DL>
<DT>public class <B>Loader</B><DT>extends java.lang.Object</DL>

<P>
<p>Downloads and deserializes scene graph nodes and node components, as well
as entire scene graphs. Downloading ready-made pieces of 3D content from an
M3G file is generally the most convenient way for an application to create
and populate a 3D scene.</p>

<h3>Supported data types</h3>

<p>The Loader can deserialize instances of any class derived from Object3D.
These include scene graph nodes such as World, Group, Camera and Light;
attribute classes such as Material, Appearance and Texture2D; animation
classes such as AnimationTrack and KeyframeSequence; and so on. No other
types of objects are supported.</p>

<p>The data to be loaded must constitute a valid M3G file. Alternatively,
it may be a PNG image file, in which case a single Image2D object is returned.
Some implementations may support other formats as well. If the data is not in
a supported format, is otherwise invalid, or can not be loaded for some other
reason, an exception is thrown.</p>

<h3>Using the Loader</h3>

<p>The Loader class cannot be instantiated, and its only members are the two
static <code>load</code> methods. The methods are otherwise identical, but
one of them takes in a byte array, while the other takes a named resource,
such as a URI or an individual file in the JAR package.</p>

<p>Any external references in the given file or byte array are followed
recursively. When using the <code>load</code> variant that takes in a URI,
the references may be absolute or relative, but when using the byte array
variant, only absolute references are allowed.</p>

<p>The <code>load</code> methods only return once the entire contents of the
given file (or byte array) have been loaded, including any referenced files.
This means that displaying content while downloading (progressive loading) is
not supported.</p>

<h3>Managing the loaded objects</h3>

<p>The <code>load</code> methods return an array of Object3Ds. These
are the root level objects in the file; in other words, those objects
that are not referenced by any other objects. The array is guaranteed
not to contain any null objects, but the order of the objects in the
array is undefined.</p>

<p>The non-root objects (often the majority) can be found by following
references recursively, starting from the root objects. This can be done
conveniently with the <A HREF="../../../javax/microedition/m3g/Object3D.html#getReferences(javax.microedition.m3g.Object3D[])"><CODE>getReferences</CODE></A>
method in Object3D. Another way to find a specific object is to tag it
with a known user ID at the authoring stage, and search for that among
the loaded objects using the <code>find</code> method.. See the class
description for <A HREF="../../../javax/microedition/m3g/Object3D.html">Object3D</A> for more information.</p>

<p>Since the root-level objects are returned in an Object3D array, the
application must find out their concrete types before using their full
functionality. In the typical case, when the content is developed in
conjunction with the application code and deployed in the same JAR file,
the application should know what the root-level objects are. If this
information is not available, or there is a need to check that the
objects are as expected, the application can use the run-time type
information that is built into Java. For example, a simple animation
player application might want to check that the downloaded object is
indeed a World, and display an appropriate error message otherwise.</p>

<h3>Validity of the loaded objects</h3>

<p>The set of objects returned by the Loader, comprising the root
level objects as well as their descendants, is guaranteed to be valid
and consistent with the API.  In other words, it should be possible to
construct the same scene graph using the API with no exceptions being
thrown. For example, if a Mesh object is returned, the application can
rest assured that it is in a state that can be reached via the
API.</p>

<p>However, it is not guaranteed that the loaded content is
renderable. Conditions that cause deferred exceptions are not checked
for, and may exist within the loaded objects. This allows fragmentary
scene graphs, which are invalid for rendering, to be loaded and
assembled by the application into a valid scene graph.</p>

<h3>Implementation guidelines</h3>

<p>Implementations must not rely on the file extension (such as ".png") to
determine the type of the file that is to be loaded. Instead, if the MIME
type is available, that should be used to screen out unrecognized files
without examining the contents. If the MIME type is not available (such
as when loading from a byte array), or it does indicate a supported format,
the implementation must ascertain the file type based on its contents. M3G
files can be recognized from the <a href="../../../file-format.html#
FileIdentifier">file identifier</a>, and PNG files from their corresponding
<a href="http://www.w3.org/TR/PNG/#5PNG-file-signature">signature</a>.</p>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><a href="../../../file-format.html">M3G (JSR-184) file format</a>, 
<a href="http://www.w3.org/TR/PNG">PNG file format</a><DT><b>Example:</b><DD><div class="example_title">A code fragment illustrating the use of Loader and <code>find</code>.

</div><pre class="example"> <span class="example_class">Object</span>3D[] roots=<span class="example_literal">null</span>;
 
<span class="example_control">try</span> {
    <span class="example_comment">// Load a World and an individual Mesh over http.</span>
 
    roots = <span class="example_class">Loader</span>.load(<span class="example_string">"http://www.example.com/myscene.m3g"</span>);
} <span class="example_control">catch</span>(<span class="example_class">IOException</span> e) {
    <span class="example_comment">// couldn't open the connection, or invalid data in the file</span>
}
 
<span class="example_comment">// The root objects must be cast from Object3D to their immediate types</span>
<span class="example_comment">// (Mesh and World) before their full functionality can be used. Since</span>
<span class="example_comment">// the relative ordering of the root objects is unspecified, we can't</span>
<span class="example_comment">// assume that the World object is always at index 0, for example. Instead,</span>
<span class="example_comment">// we identify the World by its user ID of 1, which we have assigned to it</span>
<span class="example_comment">// at the authoring stage.</span>
 
<span class="example_class">World</span> myWorld;                      <span class="example_comment">// contains our entire scene graph</span>
<span class="example_class">Mesh</span> myMesh;                        <span class="example_comment">// an individual mesh for immediate mode</span>
 
<span class="example_control">if</span> (roots[0].getUserID() == 1) {    <span class="example_comment">// our World has a user ID of 1</span>
    myWorld = (<span class="example_class">World</span>) roots[0];
    myMesh = (<span class="example_class">Mesh</span>) roots[1];
} <span class="example_control">else</span> {
    myWorld = (<span class="example_class">World</span>) roots[1];
    myMesh = (<span class="example_class">Mesh</span>) roots[0];
}
 
<span class="example_comment">// Turn on perspective correction for the Mesh.</span>
 
<span class="example_class">Appearance</span> a = myMesh.getAppearance(0);  <span class="example_comment">// get the appearance of the mesh</span>
<span class="example_class">PolygonMode</span> p = a.getPolygonMode();      <span class="example_comment">// get its polygon attributes</span>
p.setPerspectiveCorrectionEnable(<span class="example_literal">true</span>);  <span class="example_comment">// enable perspective correction</span>
 
<span class="example_comment">// Find a specific Camera node in the World, and set it as the currently</span>
<span class="example_comment">// active camera in the world. We've previously assigned the userID "10"</span>
<span class="example_comment">// to that camera node.</span>
 
<span class="example_class">Camera</span> myCamera = (<span class="example_class">Camera</span>) myWorld.find(10);
myWorld.setActiveCamera(myCamera);
 
<span class="example_comment">// Load an individual PNG file.</span>
 
<span class="example_class">Image</span>2D textureImage=<span class="example_literal">null</span>;
 
<span class="example_control">try</span> {
     textureImage = (<span class="example_class">Image</span>2D)<span class="example_class">Loader</span>.load(<span class="example_string">"/texture.png"</span>)[0];
} <span class="example_control">catch</span>(<span class="example_class">IOException</span> e) {
     <span class="example_comment">// couldn't load the PNG file</span>
}</pre></DD></DD></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../javax/microedition/m3g/Object3D.html">Object3D</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/m3g/Loader.html#load(byte[], int)">load</A></B>(byte[]&nbsp;data,
     int&nbsp;offset)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deserializes Object3D instances from the given byte array,
 starting at the given offset. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../javax/microedition/m3g/Object3D.html">Object3D</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/m3g/Loader.html#load(java.lang.String)">load</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deserializes Object3D instances from the named resource.
 </TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="load(java.lang.String)"><!-- --></A><H3>
load</H3>
<PRE>
public static <A HREF="../../../javax/microedition/m3g/Object3D.html">Object3D</A>[] <B>load</B>(java.lang.String&nbsp;name)
                       throws java.io.IOException</PRE>
<DL>
<DD><p>Deserializes Object3D instances from the named resource.
 The name of the resource is as defined by
 <code>Class.getResourceAsStream(name)</code>, or a URI. The
 types of data that can be loaded with this method are defined
 in the class description.</p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - name of the resource to load from
<DT><B>Returns:</B><DD>an array of newly created Object3D instances
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if <code>name</code> is null
<DD><CODE>java.io.IOException</CODE> - if <code>name</code>, or any resource referenced
         from it, cannot be resolved or accessed
<DD><CODE>java.io.IOException</CODE> - if the data in <code>name</code>, or in any
         resource referenced from it, is not in accordance with
         the M3G and PNG file format specifications
<DD><CODE>java.lang.SecurityException</CODE> - if the application does not have the
         security permission to open a connection to load the data</DL>
</DD>
</DL>
<HR>

<A NAME="load(byte[], int)"><!-- --></A><H3>
load</H3>
<PRE>
public static <A HREF="../../../javax/microedition/m3g/Object3D.html">Object3D</A>[] <B>load</B>(byte[]&nbsp;data,
                              int&nbsp;offset)
                       throws java.io.IOException</PRE>
<DL>
<DD><p>Deserializes Object3D instances from the given byte array,
 starting at the given offset. The types of data that can be
 loaded with this method are defined in the class
 description. The byte array must not contain any relative
 references (such as "/pics/texture.png"), but complete URIs
 are allowed.</p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>data</CODE> - byte array containing the serialized objects to load<DD><CODE>offset</CODE> - index at which to start reading the <code>data</code>
        array
<DT><B>Returns:</B><DD>an array of newly created Object3D instances
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if <code>data</code> is null
<DD><CODE>java.io.IOException</CODE> - if any external references in <code>data</code>
         cannot be resolved or accessed
<DD><CODE>java.io.IOException</CODE> - if the data in <code>data</code>, or in any
         resource referenced from it, is not in accordance with
         the M3G and PNG file format specifications
<DD><CODE>java.lang.SecurityException</CODE> - if the application does not have the
         security permission to open a connection to load an
         external reference</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Loader.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<EM><B>Nov 19, 2003</B></EM></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/m3g/Light.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/m3g/Material.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Loader.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<EM>Copyright &copy 2003 Nokia Corporation. See the <a href="../../../overview-summary.html#Copyright">Copyright Notice</a> for details.</EM>
</BODY>
</HTML>
